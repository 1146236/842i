#RAMAZAN
#Bazar Store scrapping
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.common.exceptions import NoSuchElementException
from csv import writer
from time import sleep


driver = webdriver.Chrome(r"C:\Rahim\Chrome_driver\chromedriver_update\chromedriver")

driver.get(r"https://bazarstore.az/15-meyv-trvz") #duz

with open('bazar1.csv', 'w', encoding='utf-8') as bazar_csv:
    csv_writer=writer(bazar_csv)
    csv_writer.writerow(["Item"])
    csv_writer.writerow(["Price"])

    while True:
        products = driver.find_elements(By.CLASS_NAME, "bs-product-row")
        for product in products :
            item = product.find_element(By.TAG_NAME, "h5").text    
            price = product.find_element(By.CLASS_NAME, "product-price-and-shipping").text
            item = item + ":"
            csv_writer.writerow([item])
            csv_writer.writerow([price])           
        try:
            next_button = driver.find_element(By.LINK_TEXT, "Növbəti")
            next_button.click()
            sleep(5)
        except NoSuchElementException:
            driver.quit()
